const content=document.body.querySelector(".content");class ApiHelper{async _callApi(e,t){const a=await fetch(e,t);console.log("Response API"),console.log(a);t=await a.json();if(console.log("Response JSON"),console.log(t),!t.notificationType)return t;NotificationHelper.addNotification(t.notificationType,t.notificationText)}async fetchCreateGroup(e){await this._callApi(`api/Group/CreateGroup?groupName=${e}`,{method:"POST"})}async fetchGetGroups(e,t){return await this._callApi(`api/Group/GetGroups?course=${e}${t?`&year=${t}`:""}`)}async fetchGetStudents(e,t){return await this._callApi(`api/StudentCard/GetStudents?groupId=${e}${t?`&year=${t}`:""}`)}async fetchGetStudent(e){return await this._callApi(`api/StudentCard/ShowStudentInfo?studentId=${e}`)}async fetchCreateReport(e){await this._callApi(`api/Report/CreateReport?studentId=${e}`)}async fetchCreateYearPlan(e){await this._callApi("api/YearPlan/AddYearPlan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async fetchUpdateYearPlan(e,t){await this._callApi(`api/YearPlan/UpdateYearPlan?yearPlanId=${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async fetchGetYearPlan(e,t){return await this._callApi(`api/YearPlan/GetYearPlanByGroup?groupId=${e}&year=${t}`)}async fetchGetProgress(e,t,a){return await this._callApi(`api/Progress/GetProgress?year=${e}&groupId=${t}&semesterId=${a}`)}async fetchUpdateProgress(e){await this._callApi("api/Progress/UpdateProgress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async fetchGetSpecialities(e){return await this._callApi(`api/StudentCard/GetSpecialities?degreeId=${e}`)}async fetchStudentCardSave(e){await this._callApi("api/StudentCard/SaveStudentCardInfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async fetchStudentCardUpdate(e,t){await this._callApi(`api/StudentCard/UpdateStudentCardInfo?studentId=${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async fetchGetStudentsForTransfer(e,t){return await this._callApi(`api/Transfer/GetStudentsForTransfer?groupId=${e}&year=${t}`)}async fetchUpdateTransferStudents(e){await this._callApi("api/Transfer/TransferStudents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}}const notificationContainer=document.querySelector(".notification__list"),notificationSettings={SuccessEnum:{timeout:5e3,title:"Успішно",icon:'<i class="success-icon fas fa-check-circle"></i>',type:"success"},WarningEnum:{timeout:6e3,title:"Попередження",icon:'<i class="warning-icon fas fa-exclamation-circle"></i>',type:"warning"},ErrorEnum:{timeout:6e3,title:"Помилка",icon:'<i class="error-icon fas fa-times-circle"></i>',type:"error"}};class NotificationHelper{static addNotification(e,t){let a=notificationSettings[e];a.text=t;let l=this._getNotificationElement(a);notificationContainer.insertAdjacentElement("beforeend",l),setTimeout(()=>{l.classList.remove("showNotification"),setTimeout(()=>{l.remove()},700)},a.timeout)}static _getNotificationElement(e){let t=`
            <li class="notification__list-item showNotification ${e.type}">
                <div class="notification__list-item-container">
                    ${e.icon}
                    <span class="notification__list-item-title">
                        ${e.title}
                    </span>
                </div>
                <span class="notification__list-item-text">
                    ${e.text}
                </span>
            </li>
        `;return this._createElementFromHTML(t.trim())}static _createElementFromHTML(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}}const mask=document.body.querySelector(".loading-mask");function toggleMask(){mask.classList.toggle("show")}const apiHelper=new ApiHelper;async function getGroupsAsOptions(e,t){let a=[];const l=await apiHelper.fetchGetGroups(e,t);return l&&(a=l.map(e=>`<option value=${e.groupId}>${e.groupName}</option>`),a.push(optionDefault)),a}async function getStudentsAsOptions(e,t){let a=[];const l=await apiHelper.fetchGetStudents(e,t);return l&&(a=l.map(e=>`<option value=${e.studentId}>${e.studentName}</option>`),a.push(optionDefault)),a}async function getSpecialitiesAsOptions(e){let t=[];const a=await apiHelper.fetchGetSpecialities(e);return a&&(t=a.map(e=>`<option value=${e.id}>${e.name}</option>`),t.push(optionDefault)),t}function initSidebar(){let e=document.body.querySelectorAll("a[data-page*='-page'"),t=document.body.querySelectorAll(".sidebar__menu-item");e.forEach(e=>{e.addEventListener("click",e=>{setPageByAttribute(e.target.getAttribute("data-page")),t.forEach(e=>e.classList.remove("active")),e.target.closest(".sidebar__menu-item").classList.add("active")})})}function getGroupItemWithButton(e,t,a){return""==t||""==e||null==a?null:`
        <li class="group__item" data-group-id=${t}>
            ${a}
            <span>${e}</span>
        </li>
    `}function removeCurriculumRow(t){if(!t.hasAttribute("disabled")){let e=t.closest(".curriculum__table-row-data");e.remove()}}function addCurriculumRow(e){return`
        <div class="curriculum__table-row curriculum__table-row-data" >
            <div class="item item__no-border">
                <button class="btn curriculum__table-row-btn" id="remove-row-btn" onclick="removeCurriculumRow(this);" ${e?"disabled":""} data-is-disabled>
                    <i class="btn-icon far fa-minus-square"></i>
                </button>
            </div>
            <div class="item display-none">
                <input class="item__data-subject-id" data-table-key="id" type="text" value="${e?.id??0}" ${e?"disabled":""} data-is-disabled>
            </div>
            <div class="item">
                <input class="item__data-subject" data-table-key="name" type="text" value="${e?.name??""}" ${e?"disabled":""} data-is-disabled>
            </div>
            <div class="item item__col-2">
                <div class="item__subitem">
                    <label for="hours">Годин</label>
                    <input class="item__data-hours" data-table-key="hours" type="text" value="${e?.hours??""}" id="hours"
                        pattern="[0-9]" ${e?"disabled":""} data-is-disabled>
                </div>
                <div class="item__subitem">
                    <label for="ects">Кредитів</label>
                    <input class="item__data-credits" data-table-key="ects" type="text" value="${e?.ects??""}" id="ects"
                        pattern="[0-9]" ${e?"disabled":""} data-is-disabled>
                </div>
            </div>
            <div class="item item__col-2">
                <select name="control-form-fall" data-table-key="individualTaskFallType" id="individual-task-fall" ${e?"disabled":""} data-is-disabled>
                    <option value="" ${0==e?.individualTaskFallType?"selected":""}></option>
                    <option value="1" ${1==e?.individualTaskFallType?"selected":""}>1</option>
                    <option value="2" ${2==e?.individualTaskFallType?"selected":""}>2</option>
                    <option value="3" ${3==e?.individualTaskFallType?"selected":""}>КР</option>
                </select>
                <select name="control-form-fall" data-table-key="controlFallType" id="control-fall" ${e?"disabled":""} data-is-disabled>
                    <option value="" ${0==e?.controlFallType?"selected":""}></option>
                    <option value="1" ${1==e?.controlFallType?"selected":""}>Залік</option>
                    <option value="2" ${2==e?.controlFallType?"selected":""}>Екзамен</option>
                </select>
            </div>
            <div class="item item__col-2">
                <select name="control-form-fall" data-table-key="individualTaskSpringType" id="individual-task-spring" ${e?"disabled":""} data-is-disabled>
                    <option value="" ${0==e?.individualTaskSpringType?"selected":""}></option>
                    <option value="1" ${1==e?.individualTaskSpringType?"selected":""}>1</option>
                    <option value="2" ${2==e?.individualTaskSpringType?"selected":""}>2</option>
                    <option value="3" ${3==e?.individualTaskSpringType?"selected":""}>КР</option>
                </select>
                <select name="control-form-spring" data-table-key="controlSpringType" id="control-spring" ${e?"disabled":""} data-is-disabled>
                    <option value="" ${0==e?.controlSpringType?"selected":""}></option>
                    <option value="1" ${1==e?.controlSpringType?"selected":""}>Залік</option>
                    <option value="2" ${2==e?.controlSpringType?"selected":""}>Екзамен</option>
                </select>
            </div>
            <div class="item">
                <input class="item__data-department" data-table-key="department" type="text" value="${e?.department??""}" ${e?"disabled":""} data-is-disabled>
            </div>
        </div>
    `}function getCurriculumTable(e=!1){return`
        <div class="curriculum__table">
            <div class="curriculum__table-row curriculum__table-head">
                <div class="item item__no-border"></div>
                <div class="item"><span>Назва дисципліни</span></div>
                <div class="item"><span>Кількість годин/кредитів ECTS</span></div>
                <div class="item item__grid">
                    <p>Осінній семестр</p>
                    <div class="item__col-2">
                        <span>Індивідуальне завдання</span>
                        <span>Форма контролю</span>
                    </div>
                </div>
                <div class="item item__grid">
                    <p>Весняний семестр</p>
                    <div class="item__col-2">
                        <span>Індивідуальне завдання</span>
                        <span>Форма контролю</span>
                    </div>
                </div>
                <div class="item"><span>Кафедра</span></div>
            </div>

            <div class="curriculum__table-row curriculum__table-row-last">
                <div class="item item__no-border item__full-row">
                    <button class="btn curriculum__table-row-btn" id="add-row-btn" ${e?"disabled":""} data-is-disabled>
                        <i class="btn-icon far fa-plus-square"></i>
                    </button>
                </div>
            </div>
        </div>
    `}function getProgressSubjectCell(e){var t=e?.isCourseWorkExist;return`
        <li class="progress__row-cell progress__row-cell-subject${t?"-with-cw":""}" data-subject-id="${e.id}">
            <span style="${t?"width: 65px":""}">${e.name}</span>
            ${t?`
                    <span style="width: 30px">КР</span>
                `:""}
        </li>
    `}function getProgressStudentRow(i,e){return`
        <div class="progress__row progress__row-student" data-student-id="${i.id}">
            <div class="progress__row-cell progress__row-cell-student">
                <span>${i.name}</span>
            </div>
            <ul class="progress__row-cell progress__row-cell-marks">
                ${e.map(t=>{let e=i.subjects.find(e=>e.id==t.id);var a=e?.mark??"",l=e?.modifiedOn?e.modifiedOn.split("T")[0]:"",s=e?.taskMark??"";return console.log(l),`
                            <li class="progress__row-cell progress__row-cell-mark${t.isCourseWorkExist?"-with-cw":""}" >
                                <div style="display: flex; flex-direction: column;" subject-mark>
                                    <input class="progress__row-cell-mark-value" type="text" value="${a}" pattern="[0-9]" data-subject-id="${t.id}" disabled>
                                    <input class="progress__row-cell-mark-date" type="date" value="${l}" disabled/>
                                </div>
                                <div subject-cw>
                                    ${t.isCourseWorkExist?`<input class="progress__row-cell-cw-value" type="text" value="${s}" pattern="[0-9]" data-subject-id="${t.id}" disabled>`:""}
                                </div>
                            </li>
                        `}).join("")}
            </ul>
            <div class="progress__row-cell progress__row-cell-final-mark">
                <span data-student-final>
                    ${Math.round(i.subjects.map(e=>e.mark)?.reduce((e,t)=>e+=t,0)/i.subjects.length)}
                </span>
            </div>
        </div>
    `}function getTransferStudentHead(){return`
        <li class="transfer__student-head">
            <span>
                ФІО
            </span>
            <span>
                Статус
            </span>
        </li>
    `}function getTransferStudentRow(e){return`
        <li class="transfer__student-row">
            <span class="display-none" data-transfer-key="id">${e.id}</span>
            <span>
                <span data-transfer-key="lastName">${e.lastName}</span>
                <span data-transfer-key="firstName">${e.firstName}</span>
                <span data-transfer-key="patronymic">${e.patronymic}</span>
            </span>
            <select name="status" data-transfer-key="stateId">
                <option value="1" ${1==e.stateId?"selected":""}>Перехід з курсу на курс</option>
                <option value="2" ${2==e.stateId?"selected":""}>Перерва в академічному навчанні</option>
                <option value="3" ${3==e.stateId?"selected":""}>Відрахований</option>
                <option value="4" ${4==e.stateId?"selected":""}>Здобув степінь</option>
            </select>
        </li>
    `}function getStudentTransferHistoryRows(e){return`
        ${e.map(e=>`
                <div class="main__col-3 student-card__show-transfer-history-row">
                    <input class="display-none" type="number" data-history-key="id" value="${e.id}" disabled/>
                    <input type="number" data-history-key="toCourse" value="${e.toCourse}" disabled/>
                    <input type="text" data-history-key="orderNumber" value="${e.orderNumber??""}" disabled/>
                    <input type="date" data-history-key="orderDate" value="${null!=e.orderDate?e.orderDate.split("T")[0]:null}" disabled/>
                    <textarea data-history-key="content" disabled>${e.content??""}</textarea>
                </div>
            `).join("")}
    `}function subscribeFormElements(){let e=document.body.querySelectorAll(".form-element-field");e.forEach(e=>e.addEventListener("change",e=>{let t=e.target;t.classList[t.value?"add":"remove"]("-hasValue")}))}const optionDefault='<option class="form-select-placeholder" value="" disabled selected></option>';class Page{constructor(){}static getPage(){return"not implemented"}static init(){console.log("not initialized")}static get is(){return"Page"}static _idsToClear(){return[]}}class MainPage extends Page{constructor(){super()}static get page(){return`
            <h1>Main page</h1>
        `}static subscribe(){super.subscribe()}static get is(){return"main--page"}}function initMainPage(){setPageByAttribute(MainPage.is)}class StudentCardAddPage extends Page{constructor(){super()}static _dataObjKeyFields=null;static get is(){return"student-card--add-page"}static get page(){return`
            <div class="student-card__add">
                <div class="student-card__add-info">
                    <h1 class="main__page-title">Навчальна картка студента</h1>

                    <div class="main__col-3">
                        <div class="form-element form-select">
                            <select class="form-element-field" id="course" data-obj-key="course">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="course">Курс</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="group" data-obj-key="groupId">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="group">Група</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="groupYear" class="form-element-field" data-obj-key="groupYear" placeholder="Введіть рік" type="number" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="groupYear">Рік</label>
                        </div>
                    </div>

                    <div class="form-element form-select">
                        <select class="form-element-field" id="degree" data-obj-key="degreeId">
                            <option class="form-select-placeholder" value="" disabled selected></option>
                            <option value="1">Бакалавр</option>
                            <option value="2">Магістр</option>
                        </select>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="degree">Рівень вищої
                            освіти/освітньо-кваліфікаційний
                            рівень</label>
                    </div>

                    <div class="form-element form-select">
                        <select class="form-element-field" id="speciality" data-obj-key="specialityId">
                            <option class="form-select-placeholder" value="" disabled selected></option>
                        </select>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="speciality">Спеціальність</label>
                    </div>

                    <div class="student-card__add-gap"></div>

                    <div class="main__col-3">
                        <div class="form-element form-input">
                            <input id="surname" data-obj-key="lastName" class="form-element-field"
                                placeholder="Введіть прізвище" type="text"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="surname">Прізвище</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="name" data-obj-key="firstName" class="form-element-field"
                                placeholder="Введіть ім'я" type="text"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="name">Ім'я</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="first-name" data-obj-key="patronymic" class="form-element-field"
                                placeholder="Введіть по-батькові" type="text" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="first-name">По-батькові</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="birthdate" data-obj-key="birthdate" class="form-element-field"
                                placeholder="Введіть дату народження" type="date" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="birthdate">Дата народження</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="birthdate-place" data-obj-key="birthPlace" class="form-element-field"
                                placeholder="Введіть місце народження" type="text" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="birthdate-place">Місце народження</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="citizenship" class="form-element-field" placeholder="Введіть громадянство"
                                type="text" data-obj-key="citizenship"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="citizenship">Громадянство</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="marital-status" data-obj-key="maritalStatusId">
                                <option class="form-select-placeholder" value="1" disabled selected></option>
                                <option value="2">Одружений/Заміжня</option>
                                <option value="3">Не одружений/Не заміжня</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="marital-status">Сімейний стан</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="graduated-school-name" class="form-element-field" placeholder="Введіть назву навчального закладу"
                                type="text" data-obj-key="graduatedSchoolName"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="graduated-school-name">Закінчив(ла)</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="graduated-year" class="form-element-field" placeholder="Введіть рік закінчення"
                                type="number" data-obj-key="graduatedYear"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="graduated-year">Рік закінчення</label>
                        </div>
                    </div>

                    <div class="form-element form-input">
                            <input id="home" class="form-element-field"
                                placeholder="Введіть місце проживання/реєстрації" type="text" data-obj-key="registration"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="home">Місце проживання/реєстрації</label>
                    </div>

                    <div class="form-element form-input">
                        <input id="benefits" class="form-element-field" placeholder="Введіть пільги якщо є"
                            type="text" data-obj-key="exemption"/>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="benefits">Наявність пільг при вступі</label>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="order-date" class="form-element-field" placeholder="Введіть дату зарахування"
                                type="date" data-obj-key="orderDate"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="order-date">Зарахований(а) наказом від</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="order-number" class="form-element-field" placeholder="Введіть №"
                                type="number" data-obj-key="orderNumber"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="order-number">№</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-select">
                            <select class="form-element-field" id="experience" data-obj-key="experienceCompetitionId">
                                <option class="form-select-placeholder" value="1" disabled selected></option>
                                <option value="2">Із стажем</option>
                                <option value="3">Без стажу</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="experience">1. За конкурсом</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="transferFrom" class="form-element-field"
                                placeholder="Введіть порядок переведення з" type="text" data-obj-key="transferFrom"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="transferFrom">2. У порядку переведення з</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="transfer-direction" class="form-element-field" placeholder="Введіть направленням"
                                type="text" data-obj-key="transferDirection"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="transfer-direction">3. За направленням</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="competition-conditions" class="form-element-field" placeholder="Введіть особливі умови"
                                type="text" data-obj-key="competitionConditions"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="competition-conditions">4. За особливими умовами участі у
                                конкурсі</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="out-of-competitionInfo" class="form-element-field"
                                placeholder="Введіть поза конкурсом" type="text" data-obj-key="outOfCompetitionInfo"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="out-of-competitionInfo">5. Поза конкурсом</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="amends" data-obj-key="amendsId">
                                <option class="form-select-placeholder" value="1" disabled selected></option>
                                <option value="2">Державний кредит</option>
                                <option value="3">Фізична особа</option>
                                <option value="4">Юридичная особа</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="amends">6. На умовах повного
                                відшкодування</label>
                        </div>
                    </div>

                    <div class="main__col-3">
                        <div class="form-element form-input">
                            <input id="employment-number" class="form-element-field" placeholder="Введіть №"
                                type="number" data-obj-key="employmentNumber"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="employment-number">Трудова книжка №</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="employment-given-date" class="form-element-field" placeholder="Введіть дату видачі"
                                type="date" data-obj-key="employmentGivenDate"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="employment-given-date">Дата видачі</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="employment-authority" class="form-element-field"
                                placeholder="Введіть ким видано" type="text" data-obj-key="employmentAuthority"/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="employment-authority">Ким видано</label>
                        </div>
                    </div>

                    <div class="form-element form-input">
                        <input id="registr-or-passport-number" class="form-element-field"
                            placeholder="Введіть реєстраційний номер облікової картки платника податків або серію та номер паспорту"
                            type="text" data-obj-key="registrOrPassportNumber"/>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="registr-or-passport-number">Реєстраційний номер облікової
                            картки платника податків або серія та номер паспорту</label>
                    </div>

                    <div class="main__buttons">
                        <button class="btn student-card__show-btn-save">
                            <i class="btn-icon fas fa-save"></i>
                            <span class="btn-text">Зберегти</span>
                        </button>
                    </div>
                </div>
            </div>
        `}static init(){this._initDataObjKeyFields(),this._studentCardSubscribe(),subscribeFormElements()}static _initDataObjKeyFields(){this._dataObjKeyFields=content.querySelectorAll("[data-obj-key]")}static _studentCardSubscribe(){const e=document.querySelector(".student-card__show-btn-save"),a=document.querySelector("#group"),t=document.querySelector("#course"),l=document.querySelector("#degree"),s=document.querySelector("#speciality");e.addEventListener("click",()=>{!async function(){let t={};StudentCardAddPage._dataObjKeyFields.forEach(e=>{t[e.getAttribute("data-obj-key")]=e.value}),apiHelper.fetchStudentCardSave(t)}()}),t.addEventListener("change",()=>{!async function(e){if(""!=e){const t=await getGroupsAsOptions(e);a.innerHTML=t.join(""),a.classList.remove("-hasValue")}}(t.value)}),l.addEventListener("change",()=>{!async function(e){let t=await getSpecialitiesAsOptions(e);s.innerHTML=t.join(""),s.classList.remove("-hasValue")}(degree.value)})}}StudentCardAddPage.is="test";class StudentCardShowPage extends Page{constructor(){super()}static _dataObjKeyFields=null;static get is(){return"student-card--show-page"}static get page(){return`
            <div class="student-card__show">
                <div class="student-card__show-general">
                    <h1 class="main__page-title">Пошук</h1>
                    <div class="student-card__show-grid">
                        <div class="form-element form-select">
                            <select class="form-element-field" id="course">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="course">Курс</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="group">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="group">Група</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="year" class="form-element-field" placeholder="Введіть рік" type="number" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="year">Рік</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="student">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="student">Студент</label>
                        </div>
                    </div>

                    <div class="main__buttons">
                        <button class="btn student-card__show-btn-find">
                            <i class="btn-icon fas fa-search"></i>
                            <span class="btn-text">Знайти студента</span>
                        </button>
                    </div>
                </div>

                <div class="student-card__show-info">
                    <h1 class="main__page-title">Навчальна картка студента</h1>
                    <div class="main__buttons">
                        <button class="btn student-card__show-btn-edit">
                            <i class="btn-icon fas fa-user-edit"></i>
                            <span class="btn-text">Редагувати</span>
                        </button>
                        <button class="btn student-card__show-btn-save">
                            <i class="btn-icon fas fa-save"></i>
                            <span class="btn-text">Зберегти</span>
                        </button>
                    </div>

                    <div class="main__col">
                        <div class="form-element form-select">
                            <select class="form-element-field" id="speciality" data-obj-key="specialityId" disabled>
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="speciality">Спеціальність</label>
                        </div>
                    </div>

                    <div class="main__col">
                        <div class="form-element form-select">
                            <select class="form-element-field" id="degree" data-obj-key="degreeId" disabled>
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">Бакалавр</option>
                                <option value="2">Магістр</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="degree">Рівень вищої
                                освіти/освітньо-кваліфікаційний
                                рівень</label>
                        </div>
                    </div>

                    <div class="main__col-3">
                        <div class="form-element form-input">
                            <input id="surname" data-obj-key="lastName" class="form-element-field" placeholder="Введіть прізвище"
                                type="text" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="surname">Прізвище</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="name" data-obj-key="firstName" class="form-element-field" placeholder="Введіть ім'я" type="text" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="name">Ім'я</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="first-name" data-obj-key="patronymic" class="form-element-field" placeholder="Введіть по-батькові"
                                type="text" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="first-name">По-батькові</label>
                        </div>
                    </div>

                    <div class="main__col-3 student-card__show-average-score">
                        <div class="form-element form-input">
                            <input id="average-score" class="form-element-field" placeholder="Введіть середній бал"
                                type="text" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="average-score">Середній бал</label>

                            <button class="btn student-card__show-average-score-btn" disabled>
                                <i class="fas fa-calculator"></i>
                            </button>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="birthdate" data-obj-key="birthdate" class="form-element-field" placeholder="Введіть дату народження"
                                type="date" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="birthdate">Дата народження</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="birthday-place" data-obj-key="birthPlace" class="form-element-field"
                                placeholder="Введіть місце народження" type="text" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="birthday-place">Місце народження</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="nationality" class="form-element-field" placeholder="Введіть громадянство"
                                type="text" data-obj-key="citizenship" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="nationality">Громадянство</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="marital-status" data-obj-key="maritalStatusId" disabled>
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="2">Одружений/Заміжня</option>
                                <option value="3">Не одружений/Не заміжня</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="marital-status">Сімейний стан</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="graduated-school-name" class="form-element-field" placeholder="Введіть назву навчального закладу"
                                type="text" data-obj-key="graduatedSchoolName" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="graduated-school-name">Закінчив(ла)</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="graduated-year" class="form-element-field" placeholder="Введіть рік закінчення"
                                type="number" data-obj-key="graduatedYear" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="graduated-year">Рік закінчення</label>
                        </div>
                    </div>

                    <div class="form-element form-input">
                        <input id="home" class="form-element-field"
                            placeholder="Введіть місце проживання/реєстрації" type="text" data-obj-key="registration" disabled/>
                        <div class="form-element-bar" ></div>
                        <label class="form-element-label" for="home">Місце проживання/реєстрації</label>
                    </div>

                    <div class="form-element form-input">
                        <input id="benefits" class="form-element-field" placeholder="Введіть пільги якщо є"
                            type="text" data-obj-key="exemption" disabled/>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="benefits">Наявність пільг при вступі</label>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="order-date" class="form-element-field" placeholder="Введіть дату зарахування"
                                type="date" data-obj-key="orderDate" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="order-date">Зарахований(а) наказом від</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="order-number" class="form-element-field" placeholder="Введіть №"
                                type="number" data-obj-key="orderNumber" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="order-number">№</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-select">
                            <select class="form-element-field" id="experience" data-obj-key="experienceCompetitionId" disabled>
                                <option class="form-select-placeholder" value="1" disabled selected></option>
                                <option value="2">Із стажем</option>
                                <option value="3">Без стажу</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="experience">1. За конкурсом</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="transferFrom" class="form-element-field"
                                placeholder="Введіть порядок переведення з" type="text" data-obj-key="transferFrom" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="transferFrom">2. У порядку переведення з</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="transfer-direction" class="form-element-field" placeholder="Введіть направленням"
                                type="text" data-obj-key="transferDirection" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="transfer-direction">3. За направленням</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="competition-conditions" class="form-element-field" placeholder="Введіть особливі умови"
                                type="text" data-obj-key="competitionConditions" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="competition-conditions">4. За особливими умовами участі у
                                конкурсі</label>
                        </div>
                    </div>

                    <div class="main__col-2">
                        <div class="form-element form-input">
                            <input id="out-of-competitionInfo" class="form-element-field"
                                placeholder="Введіть поза конкурсом" type="text" data-obj-key="outOfCompetitionInfo" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="out-of-competitionInfo">5. Поза конкурсом</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="amends" data-obj-key="amendsId" disabled>
                                <option class="form-select-placeholder" value="1" disabled selected></option>
                                <option value="2">Державний кредит</option>
                                <option value="3">Фізична особа</option>
                                <option value="4">Юридичная особа</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="amends">6. На умовах повного
                                відшкодування</label>
                        </div>
                    </div>

                    <div class="main__col-3">
                        <div class="form-element form-input">
                            <input id="employment-number" class="form-element-field" placeholder="Введіть №"
                                type="number" data-obj-key="employmentNumber" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="employment-number">Трудова книжка №</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="employment-date" class="form-element-field" placeholder="Введіть дату видачі"
                                type="date" data-obj-key="employmentGivenDate" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="employment-date">Дата видачі</label>
                        </div>
                        <div class="form-element form-input">
                            <input id="employment-issued" class="form-element-field"
                                placeholder="Введіть ким видано" type="text" data-obj-key="employmentAuthority" disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="employment-issued">Ким видано</label>
                        </div>
                    </div>

                    <div class="form-element form-input">
                        <input id="registration-number" class="form-element-field"
                            placeholder="Введіть реєстраційний номер облікової картки платника податків або серію та номер паспорту"
                            type="text" data-obj-key="registrOrPassportNumber" disabled/>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="registration-number">Реєстраційний номер облікової
                            картки платника податків або серія та номер паспорту</label>
                    </div>

                    <div class="main__show-row">
                        <div class="form-element form-select">
                            <select class="form-element-field" data-obj-key="studentStateId" id="student-status" disabled>
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">Переведений з групою</option>
                                <option value="2">В академічній відпустці</option>
                                <option value="3">Перехід в іншу группу</option>
                                <option value="4">Не закрив сесію</option>
                                <option value="5">Відрахований</option>
                                <option value="6">Здобув степінь</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="student-status">Статус студента</label>
                        </div>
                    </div>

                    <div class="main__col student-card__show-transfer-history">
                        <div class="student-card__show-transfer-history-header">
                            <span>Курс</span>
                            <span>Номер наказу</span>
                            <span>Дата наказу</span>
                            <span>Контент</span>
                        </div>
                        <div class="student-card__show-transfer-history-container">
                            
                        </div>
                    </div>
                </div>
            </div>
        `}static init(){this._initDataObjKeyFields(),this._studentCardSubscribe(),subscribeFormElements()}static _initDataObjKeyFields(){this._dataObjKeyFields=content.querySelectorAll("[data-obj-key]")}static _studentCardSubscribe(){const e=document.querySelector(".student-card__show-btn-find"),t=document.querySelector(".student-card__show-btn-edit"),a=document.querySelector(".student-card__show-btn-save"),l=document.querySelector(".student-card__show-average-score-btn"),s=document.querySelector(".student-card__show-transfer-history-container"),i=document.querySelector("#group"),o=document.querySelector("#course"),r=document.querySelector("#student"),n=document.querySelector("#speciality"),d=document.querySelector("#year");e.addEventListener("click",()=>{!async function(t){if(""!=t){const a=await apiHelper.fetchGetStudent(t);StudentCardShowPage._dataObjKeyFields.forEach(e=>{e.value=a[e.getAttribute("data-obj-key")],e.value&&e.classList.add("-hasValue")});let e=document.querySelector(".student-card__show-transfer-history-container");e.innerHTML=getStudentTransferHistoryRows(a.transferHistory)}}(r.value)}),t.addEventListener("click",()=>{this._dataObjKeyFields.forEach(e=>{e.disabled=!e.disabled});let e=s.querySelectorAll("[data-history-key]");console.log(e),e.forEach(e=>{e.disabled=!e.disabled})}),a.addEventListener("click",()=>{!async function(e){let t={};StudentCardShowPage._dataObjKeyFields.forEach(e=>{t[e.getAttribute("data-obj-key")]=""!=e.value?e.value:void 0});var a=s.querySelectorAll(".student-card__show-transfer-history-row");t.transferHistory=[...a].map(e=>{let t=e.querySelectorAll("[data-history-key]"),a={};return t.forEach(e=>{a[e.getAttribute("data-history-key")]=""!=e.value?e.value:void 0}),a}),apiHelper.fetchStudentCardUpdate(e,t)}(r.value)}),l.addEventListener("click",()=>{console.log("Average score")}),d.addEventListener("change",()=>{c(i.value,d.value)}),o.addEventListener("change",()=>{!async function(e){if(""!=e){const t=await getGroupsAsOptions(e);i.innerHTML=t.join(""),i.classList.remove("-hasValue"),r.value="",r.innerHTML=optionDefault,r.classList.remove("-hasValue")}}(o.value)}),i.addEventListener("change",()=>{c(i.value,d.value)});async function c(t,a=null){if(""!=t&&""!=a){let e=await getStudentsAsOptions(t,a);r.innerHTML=e.join(""),r.classList.remove("-hasValue")}}window.onload=async function(){let e=await getSpecialitiesAsOptions(0);n.innerHTML=e.join(""),n.classList.remove("-hasValue")}()}}class CurriculumAddPage extends Page{constructor(){super()}static get is(){return"curriculum--add-page"}static get page(){return`
            <div class="curriculum__grid">
                <div class="curriculum__find">
                    <div class="curriculum__find-filter curriculum__find-filter--add">
                        <h1 class="main__page-subtitle">Пошук</h1>
                        
                        <div class="form-element form-select">
                            <select class="form-element-field" id="course">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="course">Курс</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="group">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="group">Група</label>
                        </div>

                        <div class="main__buttons">
                            <button class="btn curriculum-group__btn-add">
                                <i class="btn-icon fa fa-plus"></i>
                                <span class="btn-text">Додати групу</span>
                            </button>
                        </div>
                    </div>
                    <div class="curriculum__find-list">
                        <h1 class="main__page-subtitle">Список груп</h1>
                        <ul class="curriculum__find-groups">

                        </ul>
                    </div>
                </div>

                <div class="curriculum__info">
                    <h1 class="main__page-title">Навчальний план студента</h1>

                    <div class="curriculum__info-head">
                        <div class="form-element form-input form-element-w250">
                            <input id="plan-name" class="form-element-field"
                                placeholder="Введіть назву навчального плану" type="text" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="plan-name">Назва навчального плану</label>
                        </div>
                        <div class="form-element form-input form-element-w150">
                            <input id="year" class="form-element-field" placeholder="Введіть рік" type="number" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="year">Рік</label>
                        </div>

                        <button class="btn curriculum__info-add-btn">
                            <i class="btn-icon fa fa-plus"></i>
                            <span class="btn-text">Створити навчальний план</span>
                        </button>
                    </div>

                    <div class="curriculum__table">
                        <div class="curriculum__table-row curriculum__table-head">
                            <div class="item item__no-border"></div>
                            <div class="item"><span>Назва дисципліни</span></div>
                            <div class="item"><span>Кількість годин/кредитів ECTS</span></div>
                            <div class="item item__grid">
                                <p>Осінній семестр</p>
                                <div class="item__col-2">
                                    <span>Індивідуальне завдання</span>
                                    <span>Форма контролю</span>
                                </div>
                            </div>
                            <div class="item item__grid">
                                <p>Весняний семестр</p>
                                <div class="item__col-2">
                                    <span>Індивідуальне завдання</span>
                                    <span>Форма контролю</span>
                                </div>
                            </div>
                            <div class="item"><span>Кафедра</span></div>
                        </div>

                        <div class="curriculum__table-row curriculum__table-row-last">
                            <div class="item item__no-border item__full-row">
                                <button class="btn curriculum__table-row-btn" id="add-row-btn">
                                    <i class="btn-icon item__data-btn-add far far fa-plus-square"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `}static init(){this._groupCardSubscribe(),subscribeFormElements()}static buttons={remove:"<i class='remove fas fa-minus-square' onClick='CurriculumAddPage.removeGroupFromList(this)'></i>"};static removeGroupFromList(e){const t=e.closest(".group__item");t.remove()}static _groupCardSubscribe(){const t=document.querySelector(".curriculum__find-groups"),e=document.querySelector(".curriculum__table"),a=document.querySelector(".curriculum__table-row-last"),l=document.querySelector("#add-row-btn"),i=document.querySelector("#year"),o=document.querySelector("#plan-name"),s=document.querySelector("#course"),r=document.querySelector("#group"),n=document.querySelector(".curriculum-group__btn-add"),d=document.querySelector(".curriculum__info-add-btn");i.addEventListener("change",()=>{console.log("year")}),s.addEventListener("change",()=>{!async function(e){if(""!=e){const t=await getGroupsAsOptions(e);r.innerHTML=t.join(""),r.classList.remove("-hasValue")}}(s.value)}),n.addEventListener("click",()=>{var e=getGroupItemWithButton(r.options[group.selectedIndex].text,r.value,CurriculumAddPage.buttons.remove);e&&t.insertAdjacentHTML("beforeend",e)}),d.addEventListener("click",()=>{if(""==i||""==o)return alert("bad");let l={subjectInfo:[]},s=e.querySelectorAll(".curriculum__table-row-data");for(let e=0;e<s.length;e++){let t=s[e].querySelectorAll("[data-table-key]"),a={};for(let e=0;e<t.length;e++)"SELECT"!=t[e].tagName&&"INPUT"!=t[e].tagName||""!=t[e].value?a[t[e].getAttribute("data-table-key")]=t[e].value:a[t[e].getAttribute("data-table-key")]=null;l.subjectInfo.push(a)}l.name=o.value,l.year=i.value,l.groupIds=[...t.children].map(e=>+e.getAttribute("data-group-id")).filter((e,t,a)=>a.indexOf(e)===t),async function(e){apiHelper.fetchCreateYearPlan(e)}(l)});l.addEventListener("click",()=>{a.insertAdjacentHTML("beforebegin",addCurriculumRow())})}}class CurriculumShowPage extends Page{constructor(){super()}static get is(){return"curriculum--show-page"}static get page(){return`
            <div class="curriculum__grid">
                <div class="curriculum__find-filter curriculum__find-filter--show">
                    <h1 class="main__page-subtitle">Пошук</h1>

                    <div class="main__col-3">
                        <div class="form-element form-input">
                            <input id="year" class="form-element-field" placeholder="Введіть рік" type="number" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="year">Рік</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="course">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="course">Курс</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="group">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="group">Група</label>
                        </div>
                        <div class="form-element form-input display-none">
                            <input id="plan-id" class="form-element-field"
                                placeholder="Введіть id навчального плану" type="text" data-is-disabled disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="plan-name">Id навчального плану</label>
                        </div>
                    </div>
                    <div class="main__buttons">
                        <button class="btn curriculum__btn-find">
                            <i class="btn-icon fas fa-search"></i>
                            <span class="btn-text">Знайти навчальний план</span>
                        </button>
                    </div>
                </div>

                <div class="curriculum__info">
                    <h1 class="main__page-title">Навчальний план групи</h1>

                    <div class="curriculum__info-head">
                        <div class="form-element form-input form-element-w250">
                            <input id="plan-name" class="form-element-field"
                                placeholder="Введіть назву навчального плану" type="text" data-is-disabled disabled/>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="plan-name">Назва навчального плану</label>
                        </div>

                        <div class="curriculum__info-buttons--show">
                            <button class="btn curriculum-info__btn-edit">
                                <i class="btn-icon far fa-edit"></i>
                                <span class="btn-text">Редагувати</span>
                            </button>
                            <button class="btn curriculum-info__btn-save">
                                <i class="btn-icon fas fa-upload"></i>
                                <span class="btn-text">Зберегти</span>
                            </button>
                        </div>
                    </div>

                    ${getCurriculumTable(!0)}
                </div>
            </div>
        `}static init(){this._subscribePageElements(),subscribeFormElements()}static _subscribePageElements(){const i=document.querySelector(".curriculum__table"),l=document.querySelector(".curriculum__table-row-last"),e=document.querySelector("#add-row-btn"),s=document.querySelector("#plan-id"),o=document.querySelector("#plan-name"),t=document.querySelector("#year"),a=document.querySelector("#course"),r=document.querySelector("#group"),n=document.querySelector(".curriculum__btn-find"),d=document.querySelector(".curriculum-info__btn-edit"),c=document.querySelector(".curriculum-info__btn-save");t.addEventListener("change",()=>{u(a.value,t.value)}),a.addEventListener("change",()=>{u(a.value,t.value)}),n.addEventListener("click",()=>{!async function(e,t){if(""!=e&&""!=t){!function(){var e=i.querySelectorAll(".curriculum__table-row-data");for(var t of e)t.remove()}();const a=await apiHelper.fetchGetYearPlan(e,t);console.log(a),s.value=a.id,s.classList.add("-hasValue"),o.value=a.name,o.classList.add("-hasValue"),a.subjectInfo.forEach(e=>{l.insertAdjacentHTML("beforebegin",addCurriculumRow(e))})}}(r.value,t.value)}),d.addEventListener("click",()=>{let e=i.querySelectorAll("[data-is-disabled]");e.forEach(e=>{e.disabled=!e.disabled})}),c.addEventListener("click",()=>{!async function(e){if(""!=e){let l={id:e,name:o.value,year:t.value,groupdIds:[r.value],subjectInfo:[]},s=i.querySelectorAll(".curriculum__table-row-data");for(let e=0;e<s.length;e++){let t=s[e].querySelectorAll("[data-table-key]"),a={};for(let e=0;e<t.length;e++)"SELECT"!=t[e].tagName&&"INPUT"!=t[e].tagName||""!=t[e].value?a[t[e].getAttribute("data-table-key")]=t[e].value:a[t[e].getAttribute("data-table-key")]=null;l.subjectInfo.push(a)}apiHelper.fetchUpdateYearPlan(e,l)}}(s.value)});async function u(e,t){if(""!=e&&""!=t){const a=await getGroupsAsOptions(e,t);r.innerHTML=a.join(""),r.classList.remove("-hasValue")}}e.addEventListener("click",()=>{e.hasAttribute("disabled")||l.insertAdjacentHTML("beforebegin",addCurriculumRow())})}}class GroupAddPage extends Page{constructor(){super()}static get is(){return"group--add-page"}static get page(){return`
            <h1 class="main__page-title">Створення групи</h1>
            <div class="group__add">
                <div class="main__col">
                    <div class="form-element form-input">
                        <input id="name" class="form-element-field" placeholder="Введіть назву групи" type="text" />
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="name">Назва групи</label>
                        <small class="form-element-hint">Формат назви групи: [Префікс]-[Номер]</small>
                    </div>
                </div>

                <div class="main__col">
                    <div class="main__buttons">
                        <button class="btn group__add__btn-save">
                            <i class="btn-icon fas fa-save"></i>
                            <span class="btn-text">Створити групу</span>
                        </button>
                    </div>
                </div>
            </div>
        `}static init(){this._groupCardSubscribe(),subscribeFormElements()}static _groupCardSubscribe(){const e=document.querySelector(".group__add__btn-save"),l=document.querySelector("#name");e.addEventListener("click",()=>{!async function(e){var t=document.querySelectorAll(".form-has-error");t.length?console.log("You should fix errors on the page!"):l.value?apiHelper.fetchCreateGroup(e):l.closest(".form-element").classList.add("form-has-error")}(l.value)}),l.addEventListener("change",e=>{let t=l.value,a=e.target.closest(".form-element");a.classList[0<t.length&&2!=t.split("-").length?"add":"remove"]("form-has-error")})}}class GroupActualizePage extends Page{constructor(){super()}static get is(){return"group--actualize-page"}static get page(){return`
            <h1 class="main__page-title">Актуалізування груп</h1>
            <div class="main__buttons">
                <button class="btn group__actualize-btn-actualize">
                    <i class="btn-icon fas fa-sync-alt"></i>
                    <span class="btn-text">Актуалізувати</span>
                </button>
            </div>
            <div class="group__actualize">
                <div class="group__actualize-filter">
                    <h1 class="group__actualize-title group__actualize-title-filter">Список неактивних груп</h1>
                    <ul class="group__actualize-items group__actualize-items-nonactive">

                    </ul>
                </div>
                <div class="group__actualize-right">
                    <h1 class="group__actualize-title group__actualize-title-right">Список груп на актуалізацію</h1>
                    <ul class="group__actualize-items group__actualize-items-to-actulize">

                    </ul>
                </div>
            </div>
        `}static init(){this._groupCardSubscribe()}static buttons={add:"<i class='add fas fa-plus-square' onClick='GroupActualizePage.addGroupToList(this, \"remove\")'></i>",remove:"<i class='remove fas fa-minus-square' onClick='GroupActualizePage.addGroupToList(this, \"add\")'></i>"};static _groupCardSubscribe(){GroupActualizePage._itemsNonActive=document.querySelector(".group__actualize-items-nonactive"),GroupActualizePage._itemsToActulize=document.querySelector(".group__actualize-items-to-actulize");const e=document.querySelector(".group__actualize-btn-actualize");e.addEventListener("click",()=>{!async function(e){e.length<=0||(await fetch("api/Group/ActivateExistingGroups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&(GroupActualizePage._itemsToActulize.innerHTML="")}([...GroupActualizePage._itemsToActulize.children].map(e=>+e.getAttribute("data-group-id")).filter((e,t,a)=>a.indexOf(e)===t))});window.onload=async function(){const e=await fetch("api/Group/GetDeactivatedGroups",{method:"GET"}),t=await e.json();GroupActualizePage._itemsNonActive.insertAdjacentHTML("beforeend",t.map(e=>getGroupItemWithButton(e.groupName,e.groupId,GroupActualizePage.buttons.add)).join("")),0==t.length&&GroupActualizePage._itemsNonActive.insertAdjacentHTML("beforeend","<span>Немає неактивних груп для актуалізації</span>")}()}static addGroupToList(e,t){const a=e.closest(".group__item");var l=a.getAttribute("data-group-id"),e=a.querySelector("span").innerText;a.remove(),GroupActualizePage["add"==t?"_itemsNonActive":"_itemsToActulize"].insertAdjacentHTML("beforeend",getGroupItemWithButton(e,l,GroupActualizePage.buttons[t]))}}class TransferPage extends Page{constructor(){super()}static get is(){return"transfer--page"}static get page(){return`
            <h1 class="main__page-title">Переведення</h1>
            <div class="transfer__grid">
                <div class="transfer__filter">
                    <h1 class="main__page-subtitle">Пошук</h1>

                    <div class="form-element form-select">
                        <select class="form-element-field" id="course">
                            <option class="form-select-placeholder" value="" disabled selected></option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="course">Курс</label>
                    </div>

                    <div class="form-element form-select">
                        <select class="form-element-field" id="group">
                            <option class="form-select-placeholder" value="" disabled selected></option>
                        </select>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="group">Група</label>
                    </div>

                    <div class="form-element form-input">
                        <input id="year" class="form-element-field" data-obj-key="year" placeholder="Введіть рік" type="number" />
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="year">Рік</label>
                    </div>

                    <div class="main__buttons">
                        <button class="btn transfer__btn-find" id="btn-find">
                            <i class="btn-icon fas fa-users"></i>
                            <span class="btn-text">Знайти студентів</span>
                        </button>
                    </div>
                </div>

                <div class="transfer__students">
                    <h1 class="main__page-subtitle">Список студентів</h1>

                    <ul class="transfer__students-list">
                        
                    </ul>

                    <div class="main__buttons">
                        <button class="btn transfer__btn-transfer" id="btn-transfer">
                            <i class="btn-icon fas fa-people-arrows"></i>
                            <span class="btn-text">Зберегти</span>
                        </button>
                    </div>
                </div>
            </div>
        `}static init(){this._groupCardSubscribe(),subscribeFormElements()}static _groupCardSubscribe(){const s=document.querySelector(".transfer__students-list"),e=document.querySelector("#year"),t=document.querySelector("#course"),i=document.querySelector("#group"),a=document.querySelector("#btn-find"),l=document.querySelector("#btn-transfer");t.addEventListener("change",()=>{!async function(e){if(""!=e){const t=await getGroupsAsOptions(e);i.innerHTML=t.join(""),i.classList.remove("-hasValue")}}(t.value)}),a.addEventListener("click",()=>{!async function(e,t){if(""!=e&&""!=t){s.innerHTML="";const a=await apiHelper.fetchGetStudentsForTransfer(e,t);s.insertAdjacentHTML("beforeend",getTransferStudentHead()),a.forEach(e=>{s.insertAdjacentHTML("beforeend",getTransferStudentRow(e))})}}(i.value,e.value)}),l.addEventListener("click",()=>{!async function(){let l=[];const e=[...s.querySelectorAll(".transfer__student-row")];e.forEach(e=>{const t=e.querySelectorAll("[data-transfer-key]");let a={groupId:i.value};t.forEach(e=>{a[e.getAttribute("data-transfer-key")]="SPAN"==e.tagName?e.innerText:e.value}),l.push(a)}),apiHelper.fetchUpdateTransferStudents(l)}()})}}class CreateReportPage extends Page{constructor(){super()}static get is(){return"create-report--page"}static get page(){return`
            <h1 class="main__page-title">Створення звіту</h1>
            <div class="create-report">
                <div class="main__col-3">
                    <div class="form-element form-select">
                        <select class="form-element-field" id="course">
                            <option class="form-select-placeholder" value="" disabled selected></option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="course">Курс</label>
                    </div>

                    <div class="form-element form-input">
                        <input id="year" class="form-element-field" placeholder="Введіть рік" type="number" />
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="year">Рік</label>
                    </div>

                    <div class="form-element form-select">
                        <select class="form-element-field" id="group">
                            <option class="form-select-placeholder" value="" disabled selected></option>
                        </select>
                        <div class="form-element-bar"></div>
                        <label class="form-element-label" for="group">Група</label>
                    </div>
                </div>
                <div class="form-element form-select">
                    <select class="form-element-field" id="student">
                        <option class="form-select-placeholder" value="" disabled selected></option>
                    </select>
                    <div class="form-element-bar"></div>
                    <label class="form-element-label" for="student">Студент</label>
                </div>
                <div class="main__buttons">
                    <button class="btn create-report__create-btn">
                        <i class="btn-icon fas fa-plus"></i>
                        <span class="btn-text">Створити звіт</span>
                    </button>
                </div>
            </div>
        `}static init(){this._groupCardSubscribe(),subscribeFormElements()}static _groupCardSubscribe(){const e=document.querySelector("#course"),t=document.querySelector("#year"),l=document.querySelector("#group"),s=document.querySelector("#student"),a=document.querySelector(".create-report__create-btn");e.addEventListener("change",()=>{i(e.value,t.value)}),t.addEventListener("change",()=>{i(e.value,t.value)}),l.addEventListener("change",()=>{!async function(e){if(""!=e){const t=await getStudentsAsOptions(e);s.innerHTML=t.join(""),s.classList.remove("-hasValue")}}(l.value)}),a.addEventListener("click",()=>{!async function(e){""!=e&&(toggleMask(),await apiHelper.fetchCreateReport(e),toggleMask())}(s.value)});async function i(e,t){if(""!=e&&""!=t){const a=await getGroupsAsOptions(e,t);l.innerHTML=a.join(""),l.classList.remove("-hasValue"),s.value="",s.innerHTML=optionDefault,s.classList.remove("-hasValue")}}}}class ProgressPage extends Page{constructor(){super()}static get is(){return"progress--page"}static get page(){return`
            <div class="progress__grid">
                <div class="progress__find">
                    <h1 class="main__page-subtitle">Пошук</h1>

                    <div class="main__col-4">
                        <div class="form-element form-input">
                            <input id="year" class="form-element-field" placeholder="Введіть рік" type="number" />
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="year">Рік</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="course">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="course">Курс</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="group">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="group">Група</label>
                        </div>
                        <div class="form-element form-select">
                            <select class="form-element-field" id="semestr">
                                <option class="form-select-placeholder" value="" disabled selected></option>
                                <option value="1">Осінній</option>
                                <option value="2">Весняний</option>
                            </select>
                            <div class="form-element-bar"></div>
                            <label class="form-element-label" for="semestr">Семестр</label>
                        </div>
                    </div>
                    <div class="main__buttons">
                        <button class="btn progress__btn-find">
                            <i class="btn-icon fas fa-table"></i>
                            <span class="btn-text">Показати</span>
                        </button>
                    </div>
                </div>

                <div class="progress__info">
                    <h1 class="main__page-title">Успішніcть</h1>

                    <div class="progress__table">
                        <div class="progress__row progress__row-head">
                            <div class="progress__row-cell progress__row-cell-title-student">
                                <span>Студент</span>
                            </div>

                            <div class="progress__row-cell progress__row-cell-title-subject">
                                <span>Назва навчальної дисципліни</span>
                            </div>
                            <ul class="progress__row-cell progress__row-cell-subjects">
                                
                            </ul>

                            <div class="progress__row-cell progress__row-cell-title-final-mark">
                                <span>Рейт. бал</span>
                            </div>
                        </div>
                    </div>

                    <div class="main__buttons">
                        <button class="btn progress__btn-edit">
                            <i class="btn-icon far fa-edit"></i>
                            <span class="btn-text">Редагувати</span>
                        </button>
                        <button class="btn progress__btn-save">
                            <i class="btn-icon fas fa-upload"></i>
                            <span class="btn-text">Зберегти</span>
                        </button>
                    </div>
                </div>
            </div>
        `}static init(){this._subscribePageElements(),subscribeFormElements()}static _subscribePageElements(){const e=document.querySelector("#year"),t=document.querySelector("#course"),l=document.querySelector("#group"),a=document.querySelector("#semestr"),s=document.querySelector(".progress__table"),i=document.querySelector(".progress__row-cell-subjects"),o=document.querySelector(".progress__btn-find"),r=document.querySelector(".progress__btn-edit"),n=document.querySelector(".progress__btn-save");e.addEventListener("change",()=>{d(t.value,e.value)}),t.addEventListener("change",()=>{d(t.value,e.value)}),o.addEventListener("click",()=>{!async function(e,t,a){if(""!=e&&""!=t&&""!=a){!function(){let a=s.querySelectorAll(".progress__row-cell-subject, .progress__row-cell-subject-with-cw");for(let e=0,t=a.length;e<t;e++)a[e].remove();let l=s.querySelectorAll(".progress__row-student");for(let e=0,t=l.length;e<t;e++)l[e].remove()}();const l=await apiHelper.fetchGetProgress(e,t,a);l.subjects.forEach(e=>{i.insertAdjacentHTML("beforeend",getProgressSubjectCell(e))}),l.students.forEach(e=>{s.insertAdjacentHTML("beforeend",getProgressStudentRow(e,l.subjects))})}}(e.value,l.value,a.value)}),r.addEventListener("click",()=>{let e=s.querySelectorAll(".progress__row-cell-marks input");e.forEach(e=>{e.disabled=!e.disabled})}),n.addEventListener("click",()=>{let a=[],e=s.querySelectorAll(".progress__row-student");e.forEach(e=>{let t={id:e.getAttribute("data-student-id"),name:e.querySelector(".progress__row-cell-student span")?.innerText};t.subjects=[...e.querySelectorAll(".progress__row-cell-mark, .progress__row-cell-mark-with-cw")].map(e=>{let t=e.querySelector(".progress__row-cell-mark-value");var a=e.querySelector(".progress__row-cell-mark-date"),e=e.querySelector(".progress__row-cell-cw-value");let l={id:+t.getAttribute("data-subject-id"),mark:""==t.value?null:t.value,modifiedOn:""==a.value?null:a.value};return e&&(l.taskMark=""==e.value?null:e.value),l}),a.push(t)}),async function(e){apiHelper.fetchUpdateProgress(e)}(a)});async function d(e,t){if(""!=e&&""!=t){const a=await getGroupsAsOptions(e,t);l.innerHTML=a.join(""),l.classList.remove("-hasValue")}}}}content||console.log("Tag with class'main__content' not found!");const mapper={"main--page":MainPage,"student-card--add-page":StudentCardAddPage,"student-card--show-page":StudentCardShowPage,"curriculum--show-page":CurriculumShowPage,"curriculum--add-page":CurriculumAddPage,"transfer--page":TransferPage,"progress--page":ProgressPage,"create-report--page":CreateReportPage,"group--add-page":GroupAddPage,"group--actualize-page":GroupActualizePage};function setPageByAttribute(t){if(t in mapper){let e=mapper[t];content.innerHTML=e.page,e.init()}else console.log(`Tag with attribute data-page='${t}' not found!`)}function init(){initSidebar(),setPageByAttribute(StudentCardShowPage.is)}init();